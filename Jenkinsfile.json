{
    "parameters": [
        "booleanParam(name: \"FORCE_DOCKERUPLOAD\", defaultValue: false, description: \"Force upload of docker images to Docker Hub\")"
    ],
    "docker": true,
    "stages": [
        "@setup",
        "@make check-static-files",
        "@make lint",
        "@make mypy",
        "@make docs",
        "@make test",
        "@make wheel",
        "@upload pypi",
        "stage(\"Upload Images to AWS ECR\"){\n            when {\n                anyOf{\n                    expression { return params.FORCE_DOCKERUPLOAD }\n                    expression { env.TAG_NAME != null }\n                    expression {\n                        bbcShouldUploadArtifacts(branches: [\"main\"])\n                    }\n                }\n            }\n            steps{\n                withBBCDockerRegistry {\n                    withBBCAWSCredentialsFile(awsAccountID: '613414153832', role: 'jenkins-ecr-access') {\n                        withBBCCloudfitPipConfFile {\n                          bbcMake(\"push\")\n                        }\n                    }\n                }\n            }\n            post {\n                always {\n                    bbcGithubNotify(context: \"push\", status: env.result)\n                }\n            }\n        }",
        "@upload docs-recursive ./docs"
    ]
}
